<!DOCTYPE html>
<html lang="en">

<head>
  <title>Peluquería Canina Snoopy</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- BOOTSTRAP CSS only-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <!-- font awesome-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <style>
    .navbar {
      margin: 0;
      border-radius: 0;
    }

    footer {
      background-color: #f2f2f2;
      padding: 25px;
    }

    .carousel-inner>.item>img {
      min-width: 100%;
      width: 100%;
      
    }
    
    /* .perro-mes-container {
      font-family: "Spicy Rice", serif !important;
    } */

    @media (max-width: 600px) {
      .carousel-caption {
        display: none;
        
      }
    }
  </style>

<!-- Navigation bar -->
  <%- include('./partials/navigation.ejs') %>
<!-- Navigation bar -->

  

<div id="main" class="container perro-mes-container align-items-center">

  <!-- carrusel -->
  <div class="col-md-16 mx-auto py-5">
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
          aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
          aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
          aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="" class="d-block w-100" alt="..." id="carousel_1">
        </div>
        <div class="carousel-item">
          <img src="" class="d-block w-100" alt="..." id="carousel_2">
        </div>
        <div class="carousel-item">
          <img src="" class="d-block w-100" alt="..." id="carousel_3">
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
          data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
          data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
    </div>
  <!-- Fin carrusel -->

  <!-- Perro del mes -->
      <div class="row">
        <div class="col-lg-12 text-center my-2">
          <h1 class="my-5 subtitle" style="color: #FFED9C">
            Nuestro perrito del mes</h1>
          <h2 class="my-5" style="color: #DA0E83;">
            ¡Descubre si tu peludito es nuestro destacado del mes!
          </h2>
        </div>
      </div>
      <div class="row pb-2">
        <div class="mes">
          <a class="fancylight popup-btn" data-fancybox-group="light">
            <img class="img-fluid" src="/public/images/perro1.jpg" alt="" style="border-radius: 10%; filter: drop-shadow(5px 5px 5px #6b6b6b);">
          </a>
        </div>
      </div>
    </div>

    <!-- Fin perro del mes -->

    <!-- Footer -->
    <%- include('./partials/footer.ejs') %>
    <!-- Fin Footer -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../public/js/general-user.js"></script>

    <!-- Script para funcionamiento del banner-->
    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        const carouselInner = document.querySelector('.carousel-inner');
        const carouselItems = document.querySelectorAll('.carousel-item');
        const carouselPrevButton = document.querySelector('.carousel-control-prev');
        const carouselNextButton = document.querySelector('.carousel-control-next');
        const apiUrl = 'http://18.231.252.59/api/banner/list?active=true';
        const defaultImageUrl = '/public/images/perro1.jpg'; // Ruta de la imagen por defecto
    
        try {
          const response = await fetch(apiUrl, {
            method: 'GET',
            mode: 'cors',
          });
    
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }
    
          const data = await response.json();
    
          if (data.status === 'Success' && data.banners && data.banners.banners.length > 0) {
            data.banners.banners.forEach((banner, index) => {
              if (index < carouselItems.length) {
                let imageUrl = defaultImageUrl; // Por defecto, asignar la imagen por defecto
    
                // Verificar si el banner tiene una imagen asignada
                if (banner.image) {
                  imageUrl = `http://18.231.252.59/api/banner/showimage/${banner._id}`;
                }
    
                const imgElement = carouselItems[index].querySelector('img');
                imgElement.src = imageUrl;
                imgElement.alt = banner.title;
    
                // Optionally, update carousel captions if needed
                const captionElement = carouselItems[index].querySelector('.carousel-caption');
                if (captionElement) {
                  captionElement.innerHTML = `
                    <h5>${banner.title}</h5>
                    <p>${banner.description}</p>
                  `;
                }
              }
            });
    
            // Activar el carrusel después de cargar las imágenes
            const carousel = new bootstrap.Carousel(document.querySelector('#carouselExampleIndicators'), {
              interval: 5000, // Intervalo de 5 segundos
              wrap: data.banners.banners.length > 1, // Permitir el rebobinado automático solo si hay más de un banner
            });
    
            // Deshabilitar las flechas si solo hay un banner activo
            if (data.banners.banners.length === 1) {
              carouselPrevButton.style.display = 'none';
              carouselNextButton.style.display = 'none';
            }
    
          } else {
            // Handle case where no active banners are found
            console.error('No se encontraron banners activos o la estructura de datos es incorrecta.');
          }
        } catch (error) {
          console.error('Error al obtener los banners:', error);
        }
      });
    </script>

</body>

</html>
